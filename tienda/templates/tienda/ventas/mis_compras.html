{% extends 'tienda/inicio/base.html' %}
{% load static %}
{% load humanize %}

{% block titulo %}Pedidos{% endblock %}

{% block contenedor %}
<div class="container mt-5">
  <h1 class="text-center">Pedidos</h1>
<br>
    <div class="table-responsive">
        {% if pedidos %}
        <table class="table table-striped table-bordered text-center">
            <thead class="table-dark">
                    <tr>
                        <th>Nombre Del cliente</th>
                        <th>ID Pedido</th>
                        <th>Producto</th>
                        <th>Cantidad</th>
                        <th>Precio</th>
                        <th>Total</th>
                        <th>Fecha de Venta</th>
                        <th>Estado</th>
                    </tr>
                </thead>
                <tbody>
                    {% for detalle in pedidos %}
                        <tr>
                            <td>{{ detalle.venta.usuario.nombre }}</td>  <!-- Acceso al nombre del usuario -->
                            <td>{{ detalle.venta.id }}</td>
                            <td>{{ detalle.producto.nombre }}</td>
                            <td>{{ detalle.cantidad }}</td>
                            <td>{{ detalle.precio_historico }}</td>
                            <td>{{ detalle.total|floatformat:2 }}</td>
                            <td>{{ detalle.venta.fecha_venta|date:"d/m/Y H:i" }}</td>
                            <td>
                                {% if detalle.venta.estado == 3 %}
                                    <span style="color: red;">Rechazada</span>
                                    <br>
                                    <strong>Motivo:</strong> {{ detalle.venta.motivo_rechazo }}
                                {% elif detalle.venta.estado == 1 %}
                                    <span style="color: gray;">Pendiente</span>
                                {% elif detalle.venta.estado == 2 %}
                                    <span style="color: green;">Pagada</span>
                                {% elif detalle.venta.estado == 4 %}
                                    <span style="color: blue;">Enviado</span>
                                {% endif %}
                            </td>                    
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
                <p class="text-center">No tienes pedidos registrados.</p>
        {% endif %} 
    </div>
</div>
{% endblock %}
